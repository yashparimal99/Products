<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Home Loan Application Form</title>
 
  <!-- Bootstrap CSS & Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
 
  <style>
    body { background:#f8f9fa; font-family: Arial, sans-serif; }
    h1 { color:#fff; margin-bottom:16px; font-weight:700; }
    label { font-weight:600; }
    .section-title { background:#0B4D83; color:#786d6d; padding:10px 15px; margin:24px 0 16px; border-radius:6px; font-size:1.1rem; }
    .required::after { content:" *"; color:#dc3545; }
    .btn-custom { background:#0B4D83; color:#fff; border:none; }
    .btn-custom:hover { background:#7a0f39; color:#fff; }
    .navbar { position: sticky; top: 0; z-index: 1000; }
    nav.breadcrumb-container { padding:10px 20px; background:#fff; }
  </style>
 
  <style>
    :root { --primary-color: #0B4D83; --gray-color: #f1f1f1; --dark-gray: #444; }
    body { background-color: white; font-family: 'Segoe UI', sans-serif; color: #333; }
    .top-bar { background-color: var(--primary-color); color: white; padding: 20px; }
    .top-bar h4 { margin: 0; font-weight: 600; }
    .card { border: none; border-radius: 15px; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05); }
    .section-title { font-size: 18px; font-weight: bold; margin-bottom: 10px; color: var(--primary-color); }
    .status-approved { color: green; font-weight: 500; }
    .status-pending { color: orange; font-weight: 500; }
    .highlight-box { background-color: var(--primary-color); color: white; padding: 20px; border-radius: 12px; text-align: center; }
    .highlight-box h5 { font-size: 20px; margin-bottom: 0; }
    .nav-btns button { background-color: white; border: 1px solid var(--primary-color); color: var(--primary-color); margin-right: 10px; }
    .nav-btns button:hover { background-color: var(--primary-color); color: white; }
    .calendar-box { border: 1px solid var(--primary-color); border-radius: 10px; padding: 15px; }
    .graph-placeholder, .map-placeholder { height: 200px; background: repeating-linear-gradient(45deg,#ccc,#ccc 10px,#eee 10px,#eee 20px); border-radius: 10px; }
    .user-img { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; }
    .pending-list li { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #ddd; }
    .hover-shadow:hover { box-shadow: 0 0 15px rgba(151, 20, 77, 0.3); transform: scale(1.01); transition: 0.2s ease-in-out; }
    .border-custom-left { border: 1px solid #0B4D83; border-radius: 5px; }
    .card.custom-bordered { border: 1px solid #0B4D83; border-radius: 8px; }
    footer { background-color: #0B4D83; color: white; padding: 1rem 0; font-size: 0.9rem; text-align: center; line-height: 1.4; }
    .breadcrumb a { color:#0B4D83; text-decoration:none; }
    .breadcrumb .active { color:#0B4D83; font-weight:bold; }
  </style>
 
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@600;700;800&display=swap');
    .digi-bank-logo { display: flex; align-items: center; gap: 12px; text-decoration: none; transition: transform 0.3s ease; }
    .digi-bank-logo:hover { transform: scale(1.05); }
    .logo-icon { width: 50px; height: 50px; background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #4facfe 100%); border-radius: 12px; display: flex; align-items: center; justify-content: center; position: relative; box-shadow: 0 6px 18px rgba(102, 126, 234, 0.3), 0 2px 6px rgba(0, 0, 0, 0.1); }
    .logo-icon::before { content: ''; position: absolute; top: 8px; left: 8px; right: 8px; bottom: 8px; background: rgba(255, 255, 255, 0.95); border-radius: 8px; }
    .logo-icon::after { content: 'D'; position: absolute; color: transparent; background: linear-gradient(135deg, #667eea, #764ba2); background-clip: text; -webkit-background-clip: text; font-weight: 800; font-size: 20px; z-index: 2; }
    .logo-text { color: #fff; }
    .main-text { font-size: 20px; font-weight: 800; letter-spacing: -0.5px; line-height: 1; }
    .digi { background: linear-gradient(135deg, #87CEEB 0%, #98D8E8 25%, #FFF8DC 50%, #87CEFA 100%); background-clip: text; -webkit-background-clip: text; color: transparent; text-shadow: 0 0 10px rgba(255, 255, 255, 0.3); }
    .bank { color: #ffffff; margin-left: 3px; text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3); }
    .tagline { font-size: 9px; font-weight: 600; color: #e8f4f8; letter-spacing: 2px; text-transform: uppercase; margin-top: 2px; }
  </style>
</head>
<body>
 
  <!-- Sidebar Offcanvas -->
  <div class="offcanvas offcanvas-start" tabindex="-1" id="sidebarMenu" aria-labelledby="sidebarMenuLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="sidebarMenuLabel">Welcome, {{ user.name }} ! ({{user.role}})</h5>
      <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
      <ul class="nav flex-column">
        <li class="nav-item mb-2"><a class="nav-link text-dark active" href="userdashboard.html"><i class="bi bi-speedometer2 me-2"></i> Home</a></li>
        <li class="nav-item mb-2"><a class="nav-link text-dark" href="{{ url_for('viewaccounts') }}"><i class="bi bi-person-lines-fill me-2"></i> View Accounts</a></li>
        <li class="nav-item mb-2"><a class="nav-link text-dark" href="{{ url_for('userdashloan') }}"><i class="bi bi-cash-coin me-2"></i> Loans</a></li>
        <li class="nav-item mb-2"><a class="nav-link text-dark" href="{{ url_for('Txnhistory') }}"><i class="bi bi-clock-history me-2"></i> Transaction History</a></li>
        <li class="nav-item mb-2"><a class="nav-link text-dark" href="{{ url_for('accountbal') }}"><i class="bi bi-wallet2 me-2"></i> Check Balance</a></li>
        <li class="nav-item mb-2"><a class="nav-link text-dark" href="{{ url_for('profile') }}"><i class="bi bi-gift-fill me-2"></i> Profile</a></li>
        <li class="nav-item mb-2"><a class="nav-link text-dark" href="{{ url_for('paybill') }}"><i class="bi bi-credit-card me-2"></i> Pay Bill</a></li>
        <li class="nav-item mb-2"><a class="nav-link text-dark" href="#"><i class="bi bi-person-rolodex me-2"></i> Get Contact</a></li>
        <li class="nav-item mb-2"><a class="nav-link text-dark" href="#"><i class="bi bi-shield-lock-fill me-2"></i> Privacy & Security</a></li>
      </ul>
    </div>
  </div>
 
  <!-- Top bar + navbar -->
  <div class="top-bar d-flex align-items-center">
    <button class="btn btn-outline-light btn-sm me-3" data-bs-toggle="offcanvas" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-label="Toggle sidebar"><i class="bi bi-list"></i></button>
 
    <a class="navbar-brand digi-bank-logo" href="{{ url_for('home') }}">
      <div class="logo-icon"></div>
      <div class="logo-text">
        <div class="main-text"><span class="digi">DiGi</span><span class="bank">Bank</span></div>
        <div class="tagline">Smart Banking</div>
      </div>
    </a>
 
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
            data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
            aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
 
    <nav class="navbar navbar-expand-lg navbar-dark" style="background-color: #0B4D83 !important; width: 100%;">
      <div class="container-fluid">
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item"><a class="nav-link" href="{{ url_for('dashboard') }}">My Activities</a></li>
 
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="accountDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Open Account</a>
              <ul class="dropdown-menu" aria-labelledby="accountDropdown">
                <li><a class="dropdown-item" href="{{ url_for('open_account') }}">Savings Account</a></li>
                <li><a class="dropdown-item" href="{{ url_for('open_account') }}">Salary Account</a></li>
                <li><a class="dropdown-item" href="{{ url_for('open_account') }}">Current Account</a></li>
                <li><a class="dropdown-item" href="{{ url_for('open_account') }}">Safe Custody Account</a></li>
                <li><a class="dropdown-item" href="{{ url_for('open_account') }}">Pension Account</a></li>
                <li><a class="dropdown-item" href="{{ url_for('open_account') }}">PMJDY Account</a></li>
              </ul>
            </li>
 
            <li class="nav-item dropdown">
              <button class="nav-link dropdown-toggle" id="depositsDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" type="button">Deposits</button>
              <ul class="dropdown-menu" aria-labelledby="depositsDropdown">
                <li><a class="dropdown-item" href="{{ url_for('open_deposits') }}">Digital Fixed Deposits</a></li>
                <li><a class="dropdown-item" href="{{ url_for('open_deposits') }}">Fixed Deposits</a></li>
                <li><a class="dropdown-item" href="{{ url_for('open_deposits') }}">Recurring Deposits</a></li>
              </ul>
            </li>
 
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="loanDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Loans</a>
              <ul class="dropdown-menu" aria-labelledby="loanDropdown">
                <li><a class="dropdown-item" href="{{ url_for('userdashloan') }}">Home Loan</a></li>
                <li><a class="dropdown-item" href="{{ url_for('userdashloan') }}">Personal Loan</a></li>
                <li><a class="dropdown-item" href="{{ url_for('userdashloan') }}">Busniness Loan</a></li>
              </ul>
            </li>
 
            <li class="nav-item dropdown">
              <button class="nav-link dropdown-toggle" id="cardDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" type="button">Cards</button>
              <ul class="dropdown-menu" aria-labelledby="cardDropdown">
                <li><a class="dropdown-item" href="{{ url_for('open_cards') }}">Credit Cards</a></li>
                <li><a class="dropdown-item" href="{{ url_for('open_cards') }}">Debit Cards</a></li>
                <li><a class="dropdown-item" href="{{ url_for('open_cards') }}">Prepaid Cards</a></li>
                <li><a class="dropdown-item" href="{{ url_for('open_cards') }}">Forex Cards</a></li>
              </ul>
            </li>
 
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="investDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Investments</a>
              <ul class="dropdown-menu" aria-labelledby="investDropdown">
                <li><a class="dropdown-item" href="{{ url_for('userdashinvest') }}">Public Provident Fund</a></li>
                <li><a class="dropdown-item" href="{{ url_for('userdashinvest') }}">Floating Rate Saving Bonds</a></li>
                <li><a class="dropdown-item" href="{{ url_for('userdashinvest') }}">National Pension System</a></li>
              </ul>
            </li>
          </ul>
 
          <div class="d-flex align-items-center">
            <h5 class="m-0 me-2 fs-6">Welcome, {{ user.name }} ! ({{user.role}})</h5>
            <a href="{{ url_for('logout') }}" class="logout-btn btn btn-outline-light btn-sm">Logout</a>
          </div>
        </div>
      </div>
    </nav>
  </div>
 
  <!-- Breadcrumb -->
  <nav aria-label="breadcrumb" style="background-color:#f8f9fa; padding:8px 15px; border-radius:4px; margin:10px 20px;">
    <ol class="breadcrumb mb-0">
      <li class="breadcrumb-item"><a href="{{ url_for('dashboard') }}" style="color:#0B4D83;">Home</a></li>
      <li class="breadcrumb-item active" aria-current="page" style="color:#0B4D83; font-weight:bold;">Home Apply</li>
    </ol>
  </nav>
 
  <!-- Page -->
  <div class="container px-3 px-md-4 mt-3 mb-5">
    <h1>Home Loan Application Form</h1>
 
    <!-- Flash Messages -->
    {% with msgs = get_flashed_messages(with_categories=true) %}
      {% if msgs %}
        <div class="mt-2">
          {% for cat, msg in msgs %}
            <div class="alert alert-{{ 'success' if cat=='success' else 'danger' }} alert-dismissible fade show" role="alert">
              {{ msg }}
              <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}
 
    <!-- NOTE: Correct route + multipart -->
    <form action="{{ url_for('homeloan') }}" method="POST" enctype="multipart/form-data">
      <!-- A) Applicant -->
      <div class="section-title" style="background:#0B4D83; color:white; padding:10px 15px; margin:24px 0 16px; border-radius:6px; font-size:1.1rem;">
        A) PARTICULARS OF THE APPLICANT
      </div>
 
      <div class="mb-3">
        <label for="applicantName" class="form-label required">Full Name</label>
        <input type="text" class="form-control" id="applicantName" name="applicantName" required />
      </div>
 
      <div class="row mb-3">
        <div class="col-md-3">
          <label for="dob" class="form-label required">Date of Birth</label>
          <input type="date" class="form-control" id="dob" name="dob" required />
        </div>
        <div class="col-md-2">
          <label for="age" class="form-label">Age</label>
          <input type="number" class="form-control" id="age" name="age" min="0" />
        </div>
        <div class="col-md-3">
          <label for="gender" class="form-label required">Gender</label>
          <select class="form-select" id="gender" name="gender" required>
            <option value="">Select</option>
            <option>Male</option><option>Female</option><option>Other</option>
          </select>
        </div>
      </div>
 
      <div class="mb-3">
        <label for="address" class="form-label required">Current Address</label>
        <textarea class="form-control" id="address" name="address" rows="2" required></textarea>
      </div>
 
      <div class="row mb-3">
        <div class="col-md-3">
          <label for="pin" class="form-label required">PIN Code</label>
          <input type="text" class="form-control" id="pin" name="pin" required />
        </div>
        <div class="col-md-3">
          <label for="telephone" class="form-label">Telephone</label>
          <input type="tel" class="form-control" id="telephone" name="telephone" />
        </div>
        <div class="col-md-3">
          <label for="mobile" class="form-label required">Mobile No.</label>
          <input type="tel" class="form-control" id="mobile" name="mobile" required />
        </div>
      </div>
 
      <div class="row mb-3">
        <div class="col-md-3">
          <label for="nationality" class="form-label required">Nationality</label>
          <input type="text" class="form-control" id="nationality" name="nationality" required />
        </div>
        <div class="col-md-3">
          <label for="maritalStatus" class="form-label required">Marital Status</label>
          <select class="form-select" id="maritalStatus" name="maritalStatus" required>
            <option value="">Select</option>
            <option>Single</option><option>Married</option><option>Divorced</option><option>Widowed</option>
          </select>
        </div>
        <div class="col-md-3">
          <label for="pan" class="form-label required">PAN Number</label>
          <input type="text" class="form-control" id="pan" name="pan" required />
        </div>
      </div>
 
      <!-- Employment -->
      <div class="section-title" style="background:#0B4D83; color:white; padding:10px 15px; margin:24px 0 16px; border-radius:6px; font-size:1.1rem;">
        B) Employment Details
      </div>
 
      <div class="mb-3">
        <label for="employmentType" class="form-label required">Employment Type</label>
        <select class="form-select" id="employmentType" name="employmentType" required>
          <option value="">Select</option>
          <option>Salaried</option><option>Self-Employed</option><option>Professional</option><option>Business</option>
        </select>
      </div>
 
      <div class="row mb-3">
        <div class="col-md-6">
          <label for="companyName" class="form-label required">Company/Business Name</label>
          <input type="text" class="form-control" id="companyName" name="companyName" required />
        </div>
        <div class="col-md-6">
          <label for="designation" class="form-label required">Designation/Profession</label>
          <input type="text" class="form-control" id="designation" name="designation" required />
        </div>
      </div>
 
      <div class="row mb-3">
        <div class="col-md-4">
          <label for="grossIncome" class="form-label required">Gross Annual Income (₹)</label>
          <input type="number" class="form-control" id="grossIncome" name="grossIncome" required />
        </div>
        <div class="col-md-4">
          <label for="experience" class="form-label required">Total Work Experience (Years)</label>
          <input type="number" class="form-control" id="experience" name="experience" required />
        </div>
        <div class="col-md-4">
          <label for="currentExp" class="form-label">Current Company Experience (Years)</label>
          <input type="number" class="form-control" id="currentExp" name="currentExp" />
        </div>
      </div>
 
      <!-- Property -->
      <div class="section-title" style="background:#0B4D83; color:white; padding:10px 15px; margin:24px 0 16px; border-radius:6px; font-size:1.1rem;">
        C) Property details
      </div>
 
      <div class="mb-3">
        <label for="propertyAddress" class="form-label required">Property Address</label>
        <textarea class="form-control" id="propertyAddress" name="propertyAddress" rows="2" required></textarea>
      </div>
 
      <div class="row mb-3">
        <div class="col-md-3">
          <label for="propertyType" class="form-label required">Property Type</label>
          <select class="form-select" id="propertyType" name="propertyType" required>
            <option value="">Select</option>
            <option>Flat/Apartment</option><option>Independent House</option><option>Plot</option><option>Villa</option>
          </select>
        </div>
        <div class="col-md-3">
          <label for="propertyAge" class="form-label">Property Age (Years)</label>
          <input type="number" class="form-control" id="propertyAge" name="propertyAge" />
        </div>
        <div class="col-md-3">
          <label for="builtUpArea" class="form-label required">Built-up Area (sq.ft)</label>
          <input type="number" class="form-control" id="builtUpArea" name="builtUpArea" required />
        </div>
      </div>
 
      <div class="row mb-3">
        <div class="col-md-4">
          <label for="propertyValue" class="form-label required">Property Value (₹)</label>
          <input type="number" class="form-control" id="propertyValue" name="propertyValue" required />
        </div>
        <div class="col-md-4">
          <label for="loanAmount" class="form-label required">Loan Amount Required (₹)</label>
          <input type="number" class="form-control" id="loanAmount" name="loanAmount" required />
        </div>
        <div class="col-md-4">
          <label for="loanTenure" class="form-label required">Loan Tenure (Years)</label>
          <input type="number" class="form-control" id="loanTenure" name="loanTenure" required />
        </div>
      </div>
 
      <!-- Loan Details -->
      <div class="section-title" style="background:#0B4D83; color:white; padding:10px 15px; margin:24px 0 16px; border-radius:6px; font-size:1.1rem;">
        D) Loan Details
      </div>
 
      <div class="row mb-3">
        <div class="col-md-6">
          <label for="purpose" class="form-label required">Purpose of Loan</label>
          <select class="form-select" id="purpose" name="purpose" required>
            <option value="">Select Loan Type</option>
            <option value="dream-home">Dream Home Loan</option>
            <option value="home-improvement">Home Improvement Loan</option>
            <option value="plot-loan">Plot Loan</option>
            <option value="pmay">PMAY Subsidy Scheme</option>
            <option value="balance-transfer">Home Loan Balance Transfer</option>
            <option value="nri">NRI Home Loan</option>
          </select>
        </div>
        <div class="col-md-6">
          <label for="interestType" class="form-label required">Interest Type</label>
          <select class="form-select" id="interestType" name="interestType" required>
            <option value="">Select</option>
            <option>Floating</option><option>Fixed</option>
          </select>
        </div>
      </div>
 
      <!-- LIVE Calculations -->
      <div class="row g-3 mb-3">
        <div class="col-md-3">
          <label class="form-label">Calculated Interest Rate (%)</label>
          <input class="form-control" id="calcRate" readonly>
        </div>
        <div class="col-md-3">
          <label class="form-label">Estimated EMI (₹ / month)</label>
          <input class="form-control" id="calcEMI" readonly>
        </div>
      </div>
      <input type="hidden" name="interest_rate" id="interest_rate">
      <input type="hidden" name="emi_amount" id="emi_amount">
 
      <!-- Financial -->
      <div class="section-title" style="background:#0B4D83; color:white; padding:10px 15px; margin:24px 0 16px; border-radius:6px; font-size:1.1rem;">
        E) Financial Details
      </div>
 
      <div class="row mb-3">
        <div class="col-md-4">
          <label for="existingLoan" class="form-label">Existing Home Loan (₹)</label>
          <input type="number" class="form-control" id="existingLoan" name="existingLoan" />
        </div>
        <div class="col-md-4">
          <label for="otherLoan" class="form-label">Other Loans (₹)</label>
          <input type="number" class="form-control" id="otherLoan" name="otherLoan" />
        </div>
        <div class="col-md-4">
          <label for="creditCard" class="form-label">Credit Card Limits (₹)</label>
          <input type="number" class="form-control" id="creditCard" name="creditCard" />
        </div>
      </div>
 
      <div class="row mb-3">
        <div class="col-md-4">
          <label for="savings" class="form-label">Savings/Investments (₹)</label>
          <input type="number" class="form-control" id="savings" name="savings" />
        </div>
        <div class="col-md-4">
          <label for="otherAssets" class="form-label">Other Assets (₹)</label>
          <input type="number" class="form-control" id="otherAssets" name="otherAssets" />
        </div>
      </div>
 
      <!-- Bank Account -->
      <div class="section-title" style="background:#0B4D83; color:white; padding:10px 15px; margin:24px 0 16px; border-radius:6px; font-size:1.1rem;">
        F) Bank Account Details
      </div>
 
      <div class="row mb-3">
        <div class="col-md-6">
          <label for="bankName" class="form-label required">Bank Name</label>
          <input type="text" class="form-control" id="bankName" name="bankName" required />
        </div>
        <div class="col-md-6">
          <label for="accountNumber" class="form-label required">Account Number</label>
          <input type="text" class="form-control" id="accountNumber" name="accountNumber" required />
        </div>
      </div>
 
      <div class="row mb-3">
        <div class="col-md-4">
          <label for="accountType" class="form-label required">Account Type</label>
          <select class="form-select" id="accountType" name="accountType" required>
            <option value="">Select</option>
            <option>Savings</option><option>Current</option>
          </select>
        </div>
        <div class="col-md-4">
          <label for="accountYears" class="form-label required">Years with Bank</label>
          <input type="number" class="form-control" id="accountYears" name="accountYears" required />
        </div>
      </div>
 
      <!-- Co-Applicant -->
      <div class="section-title" style="background:#0B4D83; color:white; padding:10px 15px; margin:24px 0 16px; border-radius:6px; font-size:1.1rem;">
        G) Co-Applicant Details (If Any)
      </div>
 
      <div class="mb-3">
        <label for="coApplicantName" class="form-label">Full Name</label>
        <input type="text" class="form-control" id="coApplicantName" name="coApplicantName" />
      </div>
      <div class="row mb-3">
        <div class="col-md-3">
          <label for="coApplicantRelation" class="form-label">Relationship</label>
          <input type="text" class="form-control" id="coApplicantRelation" name="coApplicantRelation" />
        </div>
        <div class="col-md-3">
          <label for="coApplicantIncome" class="form-label">Annual Income (₹)</label>
          <input type="number" class="form-control" id="coApplicantIncome" name="coApplicantIncome" />
        </div>
      </div>
 
      <!-- H) Documents to be Attached (UPDATED with upload inputs) -->
      <div class="section-title" style="background:#0B4D83; color:white; padding:10px 15px; margin:24px 0 16px; border-radius:6px; font-size:1.1rem;">
        H) Documents to be Attached
      </div>
 
      <!-- Identity Proof -->
      <div class="mb-3">
        <div class="form-check mb-2">
          <input type="checkbox" class="form-check-input" id="idProof" name="idProof">
          <label class="form-check-label" for="idProof"><strong>Identity Proof</strong> (PAN/Aadhaar/Passport)</label>
        </div>
        <input type="file" class="form-control" id="idProofFile" name="idProofFile" accept=".pdf,.jpg,.jpeg,.png,.webp" disabled>
        <small class="text-muted">Accepted: PDF, JPG, PNG, WEBP — max 10MB</small>
      </div>
 
      <!-- Address Proof -->
      <div class="mb-3">
        <div class="form-check mb-2">
          <input type="checkbox" class="form-check-input" id="addressProof" name="addressProof">
          <label class="form-check-label" for="addressProof"><strong>Address Proof</strong></label>
        </div>
        <input type="file" class="form-control" id="addressProofFile" name="addressProofFile" accept=".pdf,.jpg,.jpeg,.png,.webp" disabled>
        <small class="text-muted">Accepted: PDF, JPG, PNG, WEBP — max 10MB</small>
      </div>
 
      <!-- Income Proof -->
      <div class="mb-3">
        <div class="form-check mb-2">
          <input type="checkbox" class="form-check-input" id="incomeProof" name="incomeProof">
          <label class="form-check-label" for="incomeProof"><strong>Income Proof</strong> (Salary slips / ITR)</label>
        </div>
        <input type="file" class="form-control" id="incomeProofFile" name="incomeProofFile" accept=".pdf,.jpg,.jpeg,.png,.webp" disabled>
        <small class="text-muted">Accepted: PDF, JPG, PNG, WEBP — max 10MB</small>
      </div>
 
      <!-- Property Documents -->
      <div class="mb-3">
        <div class="form-check mb-2">
          <input type="checkbox" class="form-check-input" id="propertyDocs" name="propertyDocs">
          <label class="form-check-label" for="propertyDocs"><strong>Property Documents</strong></label>
        </div>
        <input type="file" class="form-control" id="propertyDocsFile" name="propertyDocsFile" accept=".pdf,.jpg,.jpeg,.png,.webp" disabled>
        <small class="text-muted">Accepted: PDF, JPG, PNG, WEBP — max 10MB</small>
      </div>
 
      <!-- I) Declaration -->
      <div class="section-title" style="background:#0B4D83; color:white; padding:10px 15px; margin:24px 0 16px; border-radius:6px; font-size:1.1rem;">
        I) Declaration
      </div>
 
      <div class="mb-3 form-check">
        <input type="checkbox" class="form-check-input" id="declaration" name="declaration" required />
        <label class="form-check-label required" for="declaration">I declare the information provided is true and correct to the best of my knowledge.</label>
      </div>
 
      <!-- Signatures -->
      <div class="mb-3">
        <label for="applicantSignature" class="form-label required">Applicant Signature</label>
        <input type="file" class="form-control" id="applicantSignature" name="applicantSignature" accept="image/*" required />
      </div>
      <div class="mb-3">
        <label for="coApplicantSignature" class="form-label">Co-Applicant Signature (If applicable)</label>
        <input type="file" class="form-control" id="coApplicantSignature" name="coApplicantSignature" accept="image/*" />
      </div>
 
      <!-- Place/Date -->
      <div class="row mb-3">
        <div class="col-md-4">
          <label for="date" class="form-label required">Date</label>
          <input type="date" class="form-control" id="date" name="date" required />
        </div>
        <div class="col-md-4">
          <label for="place" class="form-label required">Place</label>
          <input type="text" class="form-control" id="place" name="place" required />
        </div>
      </div>
 
      <button type="submit" class="btn btn-custom mb-5">Submit Application</button>
    </form>
  </div>
 
  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
 
  <!-- Auto-calc age from DOB + Interest/EMI preview -->
  <script>
    // Age helper
    (function(){
      const dob = document.getElementById('dob');
      const age = document.getElementById('age');
      if (dob && age) {
        dob.addEventListener('change', () => {
          const d = new Date(dob.value);
          if (isNaN(d)) return;
          const now = new Date();
          let years = now.getFullYear() - d.getFullYear();
          const m = now.getMonth() - d.getMonth();
          if (m < 0 || (m === 0 && now.getDate() < d.getDate())) years--;
          age.value = years >= 0 ? years : '';
        });
      }
    })();
 
    // Interest/EMI logic (client-side preview to match server defaults)
    (function(){
      const amountEl = document.getElementById('loanAmount');
      const tenureEl = document.getElementById('loanTenure');
      const typeEl   = document.getElementById('interestType');
      const rateOut  = document.getElementById('calcRate');
      const emiOut   = document.getElementById('calcEMI');
      const rateHidden = document.getElementById('interest_rate');
      const emiHidden  = document.getElementById('emi_amount');
 
      function compute() {
        const P = parseFloat(amountEl.value) || 0;
        const years = parseInt(tenureEl.value, 10) || 0;
        const n = years * 12;
        const interestType = (typeEl.value || '').toLowerCase();
 
        // Base rates (HOME)
        let rate = 0;
        if (interestType === 'floating') rate = 8.49;
        else if (interestType === 'fixed') rate = 9.25;
 
        // Simple adjustments (optional)
        if (years > 20) rate += 0.25;
        if (P > 10000000) rate += 0.25;
 
        let emi = 0;
        if (rate > 0 && n > 0 && P > 0) {
          const r = rate / 1200.0;
          const pow = Math.pow(1 + r, n);
          emi = P * r * pow / (pow - 1);
        }
 
        rateOut.value = rate ? rate.toFixed(2) : '';
        emiOut.value  = emi  ? emi.toFixed(2)  : '';
 
        // set hidden fields so backend can store them
        rateHidden.value = rateOut.value;
        emiHidden.value  = emiOut.value;
      }
 
      ['input', 'change'].forEach(ev => {
        amountEl.addEventListener(ev, compute);
        tenureEl.addEventListener(ev, compute);
        typeEl.addEventListener(ev, compute);
      });
      compute();
 
      // ensure latest values go with the form
      const form = document.querySelector('form');
      if (form) form.addEventListener('submit', compute);
    })();
 
    // Toggle file inputs on checkbox change; require file when checked
    (function () {
      const pairs = [
        { box: 'idProof', file: 'idProofFile' },
        { box: 'addressProof', file: 'addressProofFile' },
        { box: 'incomeProof', file: 'incomeProofFile' },
        { box: 'propertyDocs', file: 'propertyDocsFile' },
      ];
 
      function bindToggle(boxId, fileId) {
        const box = document.getElementById(boxId);
        const file = document.getElementById(fileId);
        if (!box || !file) return;
 
        function apply() {
          const on = box.checked;
          file.disabled = !on;
          file.required = on;      // required only when the user has checked the box
          if (!on) file.value = '';// clear if unchecked
        }
 
        box.addEventListener('change', apply);
        apply(); // initialize on load
      }
 
      pairs.forEach(p => bindToggle(p.box, p.file));
    })();
  </script>
</body>
</html>
 