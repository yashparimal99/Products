<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Check Balance - DigiBank</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
 
  <style>
    :root{
      --db-main:#0B4D83;
      --db-accent:#7a0f3e;
      --db-surface:#ffffff;
      --db-border:#e7edf6;
      --db-hover:#f8fbff;
      --db-muted:#6b7a88;
      --db-shadow:0 2px 10px rgba(0,0,0,.08);
      /* NEW: pink chip for account name */
      --db-pink-bg:#f9e1ea;  /* soft pink */
      --db-pink-text:#7a0f3e; /* deep rose */
    }
 
    body{ background:#f8f9fa; font-family:'Segoe UI',sans-serif; }
 
    /* Constrain page width */
    .page-wrap{
      max-width: 980px;      /* not wide */
      margin: 0 auto;
      padding: 0 14px;
    }
 
    /* Top Bar */
    .top-bar{ background:var(--db-main); color:#fff; padding:10px 16px; position:sticky; top:0; z-index:1030;}
    .logout-btn{ border:1.5px solid #fff; color:#fff;}
    .logout-btn:hover{ background:#fff; color:var(--db-main);}
 
    /* Sidebar */
    #sidebarMenu.offcanvas-start{ width:250px;}
    #sidebarMenu .offcanvas-body{ padding:.5rem 1rem;}
    #sidebarMenu .nav-link{ font-size:.92rem; padding:8px 12px; display:flex; align-items:center; gap:8px; color:#333; border-radius:6px; transition:.2s;}
    #sidebarMenu .nav-link.active{ color:var(--db-main)!important; background:#eef6ff; font-weight:700;}
    #sidebarMenu .nav-link:hover{ color:var(--db-main); background:#f3f8ff;}
 
    /* Breadcrumb */
    .breadcrumb a{ color:var(--db-main); text-decoration:none;}
    .breadcrumb .active{ color:var(--db-main); font-weight:700;}
 
    /* Logo (kept compact) */
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@600;700;800&display=swap');
    .digi-bank-logo{ display:flex; align-items:center; gap:12px; text-decoration:none; transition:.2s;}
    .digi-bank-logo:hover{ transform:scale(1.03);}
    .logo-icon{ width:44px; height:44px; background:linear-gradient(135deg,#667eea,#764ba2,#f093fb,#4facfe); border-radius:10px; position:relative; box-shadow:var(--db-shadow);}
    .logo-icon::before{ content:''; position:absolute; inset:7px; background:#fff; border-radius:7px; opacity:.95;}
    .logo-icon::after{ content:'D'; position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); font-weight:800; font-size:18px; background:linear-gradient(135deg,#667eea,#764ba2); -webkit-background-clip:text; background-clip:text; color:transparent;}
    .logo-text{ color:#fff;}
    .main-text{ font-size:18px; font-weight:800; letter-spacing:-.4px; line-height:1;}
    .digi{ background:linear-gradient(135deg,#87CEEB,#98D8E8,#FFF8DC,#87CEFA); -webkit-background-clip:text; background-clip:text; color:transparent;}
    .bank{ color:#fff; margin-left:3px;}
    .tagline{ font-size:8px; font-weight:600; color:#e8f4f8; letter-spacing:2px; text-transform:uppercase; margin-top:2px;}
 
    /* Buttons */
    .btn-digibank{
      background:var(--db-main); color:#fff; border:none; padding:7px 14px; border-radius:999px;
      font-size:.9rem; transition:.2s;
    }
    .btn-digibank:hover{ background:var(--db-accent); color:#fff;}
 
    /* Summary cards (compact) */
    .summary-card{
      background:var(--db-surface); border:1px solid var(--db-border); border-radius:10px;
      padding:14px; text-align:center; box-shadow:var(--db-shadow);
      min-height:150px; display:flex; flex-direction:column; justify-content:space-between;
      transition:.2s;
    }
    .summary-card:hover{ transform:translateY(-3px); box-shadow:0 10px 20px rgba(0,0,0,.12);}
    .summary-card .icon{ font-size:26px; color:var(--db-main); }
    .summary-card h6{ margin:.25rem 0; font-weight:700; font-size:1rem;}
    .summary-card p{ color:#555; font-size:.9rem; margin:0 0 .25rem;}
    .summary-card .value{ font-weight:800; font-size:1.15rem; color:var(--db-main);}
 
    /* Table (compact + shell) */
    .balance-box{ margin:22px auto 28px; }
    .table-shell{
      border:1px solid var(--db-border); border-radius:12px; overflow:hidden; box-shadow:var(--db-shadow); background:var(--db-surface);
    }
    .acct-table{ --bs-table-striped-bg:#fbfdff; --bs-table-hover-bg:#f6faff; margin:0; }
    .acct-table thead th{
      background:var(--db-main); color:#fff; border:none; padding:11px 14px; font-weight:800; letter-spacing:.2px;
    }
    .acct-table tbody td{ padding:9px 14px; vertical-align:middle; border-top:1px solid #eef2f8; }
    .acct-table tbody tr:hover{ background:var(--db-hover);}
    .acct-table tfoot td{
      background:#f7f9fc; font-weight:800; color:var(--db-main); padding:12px 14px; border-top:2px solid #e9eef5!important;
    }
 
    .num{ font-variant-numeric:tabular-nums; font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace; white-space:nowrap;}
 
    /* NEW: Pink account name chip (table + cards) */
    .acct-chip{
      display:inline-block;
      background:var(--db-pink-bg);
      color:var(--db-pink-text);
      font-weight:800;
      padding:4px 10px;
      border-radius:999px;
      font-size:.8rem;
    }
 
    /* Mobile account cards (smaller) */
    .acct-card{
      background:var(--db-surface); border:1px solid var(--db-border); border-radius:10px; padding:12px;
      box-shadow:var(--db-shadow); transition:.2s; height:100%;
    }
    .acct-card:hover{ transform:translateY(-2px); box-shadow:0 10px 18px rgba(0,0,0,.12);}
    .acct-top{ display:flex; align-items:center; gap:10px; margin-bottom:6px;}
    .acct-ico{
      width:36px; height:36px; border-radius:9px; display:flex; align-items:center; justify-content:center;
      background:linear-gradient(135deg,#e7f1ff,#f5f9ff); border:1px solid #d9e7fb; flex-shrink:0;
    }
    .acct-ico i{ font-size:18px; color:var(--db-main);}
    .acct-type{ font-weight:800; margin:0; font-size:.95rem;}
    .acct-type .acct-chip{ margin-right:6px; }
    .acct-num{ font-size:.92rem; color:var(--db-muted);}
    .acct-balance{ font-weight:800; color:var(--db-main); font-size:1rem; white-space:nowrap;}
    .acct-actions .btn{ padding:6px 11px; border-radius:10px; font-size:.9rem;}
    .reveal-btn{ border:none; background:transparent; color:var(--db-main); line-height:1;}
    .reveal-btn:hover{ color:var(--db-accent);}
 
    /* Visibility: cards on xs/sm, table on md+ */
    .only-mobile{ display:block;}
    .only-desktop{ display:none;}
    @media (min-width:768px){
      .only-mobile{ display:none;}
      .only-desktop{ display:block;}
    }
  </style>
</head>
<body>
 
  <!-- Sidebar -->
  <div class="offcanvas offcanvas-start" tabindex="-1" id="sidebarMenu" aria-labelledby="sidebarMenuLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="sidebarMenuLabel">Welcome, {{ user.name }} ! ({{user.role}})</h5>
      <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body">
      <ul class="nav flex-column">
        <li class="nav-item mb-2"><a class="nav-link text-dark active" href="{{ url_for('dashboard') }}"><i class="bi bi-speedometer2 me-2"></i> Home</a></li>
        <li class="nav-item mb-2"><a class="nav-link text-dark" href="{{ url_for('viewaccounts') }}"><i class="bi bi-person-lines-fill me-2"></i> View Accounts</a></li>
        <li class="nav-item mb-2"><a class="nav-link text-dark" href="{{ url_for('userdashloan') }}"><i class="bi bi-cash-coin me-2"></i> Loans</a></li>
        <li class="nav-item mb-2"><a class="nav-link text-dark" href="{{ url_for('Txnhistory') }}"><i class="bi bi-clock-history me-2"></i> Transaction History</a></li>
        <li class="nav-item mb-2"><a class="nav-link text-dark" href="{{ url_for('accountbal') }}"><i class="bi bi-wallet2 me-2"></i> Check Balance</a></li>
        <li class="nav-item mb-2"><a class="nav-link text-dark" href="{{ url_for('profile') }}"><i class="bi bi-gift-fill me-2"></i> Profile</a></li>
        <li class="nav-item mb-2"><a class="nav-link text-dark" href="{{ url_for('paybill') }}"><i class="bi bi-credit-card me-2"></i> Pay Bill</a></li>
        <li class="nav-item mb-2"><a class="nav-link text-dark" href="#"><i class="bi bi-person-rolodex me-2"></i> Get Contact</a></li>
        <li class="nav-item mb-2"><a class="nav-link text-dark" href="#"><i class="bi bi-shield-lock-fill me-2"></i> Privacy & Security</a></li>
      </ul>
    </div>
  </div>
 
  <!-- Top Bar -->
  <div class="top-bar d-flex align-items-center">
    <button class="btn btn-outline-light btn-sm me-2" data-bs-toggle="offcanvas" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-label="Toggle sidebar">
      <i class="bi bi-list"></i>
    </button>
 
    <a class="navbar-brand digi-bank-logo" href="{{ url_for('home') }}">
      <div class="logo-icon"></div>
      <div class="logo-text">
        <div class="main-text"><span class="digi">DiGi</span><span class="bank">Bank</span></div>
        <div class="tagline">Smart Banking</div>
      </div>
    </a>
 
    <nav class="navbar navbar-expand-lg navbar-dark" style="background-color: var(--db-main) !important; width: 100%;">
      <div class="container-fluid">
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item"><a class="nav-link" href="{{ url_for('dashboard') }}">My Activities</a></li>
 
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="accountDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Open Account</a>
              <ul class="dropdown-menu" aria-labelledby="accountDropdown">
                <li><a class="dropdown-item" href="{{ url_for('open_account') }}">Savings Account</a></li>
                <li><a class="dropdown-item" href="{{ url_for('open_account') }}">Salary Account</a></li>
                <li><a class="dropdown-item" href="{{ url_for('open_account') }}">Current Account</a></li>
                <li><a class="dropdown-item" href="{{ url_for('open_account') }}">Safe Custody Account</a></li>
                <li><a class="dropdown-item" href="{{ url_for('open_account') }}">Pension Account</a></li>
                <li><a class="dropdown-item" href="{{ url_for('open_account') }}">PMJDY Account</a></li>
              </ul>
            </li>
 
            <li class="nav-item dropdown">
              <button class="nav-link dropdown-toggle" href="#" id="depositsDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Deposits</button>
              <ul class="dropdown-menu" aria-labelledby="depositsDropdown">
                <li><a class="dropdown-item" href="{{ url_for('open_deposits') }}">Digital Fixed Deposits</a></li>
                <li><a class="dropdown-item" href="{{ url_for('open_deposits') }}">Fixed Deposits</a></li>
                <li><a class="dropdown-item" href="{{ url_for('open_deposits') }}">Recurring Deposits</a></li>
              </ul>
            </li>
 
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="loanDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Loans</a>
              <ul class="dropdown-menu" aria-labelledby="loanDropdown">
                <li><a class="dropdown-item" href="{{ url_for('userdashloan') }}">Home Loan</a></li>
                <li><a class="dropdown-item" href="{{ url_for('userdashloan') }}">Personal Loan</a></li>
                <li><a class="dropdown-item" href="{{ url_for('userdashloan') }}">Busniness Loan</a></li>
              </ul>
            </li>
 
            <li class="nav-item dropdown">
              <button class="nav-link dropdown-toggle" id="cardDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" type="button">Cards</button>
              <ul class="dropdown-menu" aria-labelledby="cardDropdown">
                <li><a class="dropdown-item" href="{{ url_for('open_cards') }}">Credit Cards</a></li>
                <li><a class="dropdown-item" href="{{ url_for('open_cards') }}">Debit Cards</a></li>
                <li><a class="dropdown-item" href="{{ url_for('open_cards') }}">Prepaid Cards</a></li>
              </ul>
            </li>
 
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="investDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Investments</a>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="#">Public Provident Fund</a></li>
                <li><a class="dropdown-item" href="#">Floating Rate Saving Bonds</a></li>
                <li><a class="dropdown-item" href="#">National Pension System</a></li>
              </ul>
            </li>
          </ul>
 
          <div class="d-flex align-items-center">
            <h5 class="m-0 me-2 fs-6">Welcome, {{ user.name }} ! ({{user.role}})</h5>
            <a href="{{ url_for('logout') }}" class="logout-btn btn btn-outline-light btn-sm">Logout</a>
          </div>
        </div>
      </div>
    </nav>
  </div>
 
  <!-- Breadcrumb -->
  <nav aria-label="breadcrumb" class="bg-light px-3 py-2 mt-3">
    <ol class="breadcrumb mb-0 page-wrap">
      <li class="breadcrumb-item"><a href="{{ url_for('dashboard') }}">Home</a></li>
      <li class="breadcrumb-item active" aria-current="page">Bank Balance</li>
    </ol>
  </nav>
 
  <main class="page-wrap">
    <!-- Summary Cards -->
    <div class="mt-3">
      <div class="row g-3">
        <div class="col-12 col-md-4">
          <div class="summary-card">
            <i class="bi bi-currency-rupee icon"></i>
            <div>
              <h6>Total Balance</h6>
              <p>Combined across your accounts</p>
            </div>
            <div class="value">₹ {{ '%.2f'|format(total_balance or 0) }}</div>
          </div>
        </div>
 
        <div class="col-12 col-md-4">
          <div class="summary-card">
            <i class="bi bi-wallet2 icon"></i>
            <div>
              <h6>Accounts</h6>
              <p>Linked to your profile</p>
            </div>
            <div class="value">{{ accounts|length if accounts else 0 }}</div>
          </div>
        </div>
 
        <div class="col-12 col-md-4">
          <div class="summary-card">
            <i class="bi bi-lightning-charge-fill icon"></i>
            <div>
              <h6>Quick Actions</h6>
              <p>Frequent tasks</p>
            </div>
            <div class="d-flex gap-2 justify-content-center">
              <a class="btn btn-digibank" href="{{ url_for('quicktransfer') }}">Quick Transfer</a>
              <a class="btn btn-digibank" href="{{ url_for('Txnhistory') }}">History</a>
            </div>
          </div>
        </div>
      </div>
    </div>
 
    <!-- Mobile account cards -->
    <div class="only-mobile mt-3">
      <div class="row g-2">
        {% for a in accounts %}
        {% set t = (a.account_type or '')|lower %}
        {% set last4 = (a.account_number|string)[-4:] %}
        <div class="col-12">
          <div class="acct-card">
            <div class="acct-top">
              <div class="acct-ico">
                <i class="bi
                  {% if t == 'savings' %}bi-piggy-bank{%
                  elif t == 'salary' %}bi-briefcase{%
                  elif t == 'current' %}bi-wallet2{%
                  elif t == 'pension' %}bi-people{%
                  elif t == 'safecustody' %}bi-shield-lock{%
                  elif t == 'pmjdy' %}bi-bank{%
                  else %}bi-credit-card{% endif %}"></i>
              </div>
              <div class="flex-grow-1">
                <div class="d-flex justify-content-between align-items-start flex-wrap">
                  <h6 class="acct-type mb-1">
                    <span class="acct-chip">{{ a.account_type|capitalize }}</span>
                  </h6>
                  <div class="acct-balance ms-2">₹ {{ '%.2f'|format(a.balance or 0) }}</div>
                </div>
 
                <div class="d-flex align-items-center gap-2">
                  <span class="acct-num"
                        data-full="{{ a.account_number }}"
                        data-last4="{{ last4 }}"
                        data-state="ending"> •••• •••• •••• {{ last4 }}</span>
                  <button class="reveal-btn" type="button" aria-label="Show full account number" data-role="toggle-full">
                    <i class="bi bi-eye"></i>
                  </button>
                </div>
              </div>
            </div>
 
            <div class="acct-actions d-flex gap-2">
              <a href="{{ url_for('Txnhistory') }}" class="btn btn-outline-primary btn-sm" style="border-color:var(--db-main); color:var(--db-main);">Transactions</a>
              <a href="{{ url_for('quicktransfer') }}" class="btn btn-digibank btn-sm">Transfer</a>
            </div>
          </div>
        </div>
        {% else %}
        <div class="col-12">
          <div class="acct-card text-center text-muted py-4">No accounts found.</div>
        </div>
        {% endfor %}
      </div>
    </div>
 
    <!-- Desktop table -->
    <div class="balance-box only-desktop">
      <h4 class="mb-2" style="color:var(--db-main); font-weight:800; font-size:1.25rem;">Accounts & Balances</h4>
      <div class="table-shell">
        <table class="table table-striped table-hover acct-table">
          <thead>
            <tr>
              <th style="width:36%;">Account</th>
              <th style="width:44%;">Account Number</th>
              <th class="text-end" style="width:20%;">Balance</th>
            </tr>
          </thead>
          <tbody>
            {% for a in accounts %}
            {% set t = (a.account_type or '')|lower %}
            {% set last4 = (a.account_number|string)[-4:] %}
            <tr>
              <td>
                <i class="bi
                  {% if t == 'savings' %}bi-piggy-bank{%
                  elif t == 'salary' %}bi-briefcase{%
                  elif t == 'current' %}bi-wallet2{%
                  elif t == 'pension' %}bi-people{%
                  elif t == 'safecustody' %}bi-shield-lock{%
                  elif t == 'pmjdy' %}bi-bank{%
                  else %}bi-credit-card{% endif %} me-2"></i>
                <span class="acct-chip">{{ a.account_type|capitalize }}</span>
              </td>
              <td>
                <div class="d-inline-flex align-items-center gap-2">
                  <span class="num acct-num"
                        data-full="{{ a.account_number }}"
                        data-last4="{{ last4 }}"
                        data-state="ending"> •••• •••• •••• {{ last4 }}</span>
                  <button class="reveal-btn" type="button" aria-label="Show full account number" data-role="toggle-full">
                    <i class="bi bi-eye"></i>
                  </button>
                </div>
              </td>
              <td class="text-end num">₹ {{ '%.2f'|format(a.balance or 0) }}</td>
            </tr>
            {% else %}
            <tr>
              <td colspan="3" class="text-center text-muted py-4">No accounts found.</td>
            </tr>
            {% endfor %}
          </tbody>
          <tfoot>
            <tr>
              <td colspan="2">Total Balance</td>
              <td class="text-end num">₹ {{ '%.2f'|format(total_balance or 0) }}</td>
            </tr>
          </tfoot>
        </table>
      </div>
 
      <div class="text-center mt-3">
        <a href="{{ url_for('Txnhistory') }}" class="btn btn-digibank w-100">View Transactions</a>
      </div>
    </div>
  </main>
 
  <footer class="text-white text-center py-3 mt-4" style="background-color:var(--db-main);">
    © 2025 DigiBank. All rights reserved.
  </footer>
 
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Toggle full account number (default: last 4 shown)
    document.addEventListener('click', (e) => {
      const btn = e.target.closest('[data-role="toggle-full"]');
      if (!btn) return;
 
      const span = btn.parentElement.querySelector('.acct-num');
      const icon = btn.querySelector('i');
      const full = span.getAttribute('data-full') || '';
      const last4 = span.getAttribute('data-last4') || '';
      const state = span.getAttribute('data-state') || 'ending';
 
      if (state === 'ending') {
        span.textContent =  full;
        span.setAttribute('data-state', 'full');
        btn.setAttribute('aria-label', 'Hide full account number');
        icon.classList.replace('bi-eye','bi-eye-slash');
      } else {
        span.textContent = ' •••• •••• •••• ' + last4;
        span.setAttribute('data-state', 'ending');
        btn.setAttribute('aria-label', 'Show full account number');
        icon.classList.replace('bi-eye-slash','bi-eye');
      }
    });
  </script>
</body>
</html>
 
 