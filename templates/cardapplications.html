<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Card Applications</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
 
  <!-- Fonts & Icons -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
 
  <!-- Bootstrap CSS & Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
 
  <style>
    :root{
      --primary-color:#0B4D83; --secondary-color:#1976D2; --dark-color:#263238;
      --gradient-primary:linear-gradient(135deg,#0B4D83 0%,#1976D2 100%);
      --shadow-light:0 4px 20px rgba(11,77,131,.1);
      --shadow-medium:0 8px 30px rgba(11,77,131,.15);
      --shadow-heavy:0 15px 40px rgba(11,77,131,.2);
    }
    *{box-sizing:border-box;}
    body{font-family:'Poppins',sans-serif;line-height:1.6;color:var(--dark-color);background:linear-gradient(135deg,rgba(11,77,131,.02),rgba(25,118,210,.02));min-height:100vh;display:flex;flex-direction:column;}
 
    /* Top Bar */
    .top-bar{background:var(--gradient-primary);color:#fff;display:flex;align-items:center;justify-content:space-between;padding:.8rem 1.5rem;box-shadow:var(--shadow-medium);}
    .top-bar img{height:45px;width:auto;border-radius:6px;background:#fff;padding:3px;}
    .top-bar h5{font-weight:600;margin:0;}
    .top-bar .btn-outline-light{border:1.5px solid #fff;color:#fff;font-weight:500;}
    .top-bar .btn-outline-light:hover{background:#fff;color:var(--primary-color);}
 
    /* Breadcrumb */
    .breadcrumb{background:linear-gradient(135deg,rgba(11,77,131,.05),rgba(25,118,210,.05));border-radius:15px;padding:1rem 1.5rem;margin:1.5rem;box-shadow:var(--shadow-light);}
    .breadcrumb .breadcrumb-item a{color:var(--primary-color);text-decoration:none;font-weight:500;}
    .breadcrumb .breadcrumb-item a:hover{text-decoration:underline;}
    .breadcrumb .breadcrumb-item.active{color:var(--primary-color);font-weight:600;}
 
    /* Card wrapper */
    .card{border-radius:20px;box-shadow:var(--shadow-light);transition:all .4s ease;background:linear-gradient(145deg,#ffffff,#f8f9fa);}
    .card:hover{transform:translateY(-4px);box-shadow:var(--shadow-heavy);}
    h4{color:var(--primary-color);font-weight:700;margin-bottom:1.25rem;}
 
    /* Filter buttons */
    .nav-btn{border:1.5px solid var(--secondary-color);color:var(--secondary-color);font-weight:500;}
    .nav-btn:hover,.nav-btn.active{background:var(--secondary-color);color:#fff;}
 
    /* Table */
    .table{border-radius:12px;overflow:hidden;box-shadow:var(--shadow-light);}
    .table thead{background:var(--gradient-primary);color:#fff;}
    .table-hover tbody tr:hover{background-color:rgba(25,118,210,.08);}
 
    /* Footer */
    footer{background:var(--gradient-primary);color:#fff;text-align:center;padding:15px;margin-top:auto;box-shadow:var(--shadow-medium);}
  </style>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@600;700;800&display=swap');
 
.digi-bank-logo {
  display: flex;
  align-items: center;
  gap: 12px;
  text-decoration: none;
  transition: transform 0.3s ease;
}
.digi-bank-logo:hover {
  transform: scale(1.05);
}
.logo-icon {
  width: 50px;
  height: 50px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #4facfe 100%);
  border-radius: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
  position: relative;
  box-shadow: 0 6px 18px rgba(102, 126, 234, 0.3), 0 2px 6px rgba(0, 0, 0, 0.1);
}
.logo-icon::before {
  content: '';
  position: absolute;
  top: 8px;
  left: 8px;
  right: 8px;
  bottom: 8px;
  background: rgba(255, 255, 255, 0.95);
  border-radius: 8px;
}
.logo-icon::after {
  content: 'D';
  position: absolute;
  color: transparent;
  background: linear-gradient(135deg, #667eea, #764ba2);
  background-clip: text;
  -webkit-background-clip: text;
  font-weight: 800;
  font-size: 20px;
  z-index: 2;
}
.logo-text {
  color: #fff;
}
.main-text {
  font-size: 20px;
  font-weight: 800;
  letter-spacing: -0.5px;
  line-height: 1;
}
.digi {
  background: linear-gradient(135deg, #87CEEB 0%, #98D8E8 25%, #FFF8DC 50%, #87CEFA 100%);
  background-clip: text;
  -webkit-background-clip: text;
  color: transparent;
  text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
}
.bank {
  color: #ffffff;
  margin-left: 3px;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}
.tagline {
  font-size: 9px;
  font-weight: 600;
  color: #e8f4f8;
  letter-spacing: 2px;
  text-transform: uppercase;
  margin-top: 2px;
}
 
  </style>
</head>
<body>
 
<!-- Top Bar -->
  <div class="top-bar d-flex align-items-center px-3 py-2" style="background-color:#0B4D83; color:white;">
 
 
    <!-- Logo / Image -->
    <!-- ðŸ”½ Custom DigiBank Logo -->
    <a class="navbar-brand digi-bank-logo" href="{{ url_for('home') }}">
      <div class="logo-icon"></div>
      <div class="logo-text">
        <div class="main-text">
          <span class="digi">DiGi</span><span class="bank">Bank</span>
        </div>
        <div class="tagline">Smart Banking</div>
      </div>
    </a>
 
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
            data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
            aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <!-- Title -->
    <h5 class="flex-grow-1 text-center m-0">Welcome To Cards Agent Dashboard - DigiBank</h5>
 
    <!-- Logout Button -->
    <div class="d-flex align-items-center">
      <h5 class="m-0 me-2 fs-6">Welcome, {{ user.email }} </h5>
      <a href="{{ url_for('logout') }}" class="btn btn-outline-light btn-sm ms-3">
        Logout
      </a>
    </div>
  </div> 
<!-- Breadcrumb -->
<nav aria-label="breadcrumb">
  <ol class="breadcrumb mb-0">
    <li class="breadcrumb-item"><a href="{{ url_for('dashboard') }}">Home</a></li>
    <li class="breadcrumb-item active" aria-current="page">Card Applications</li>
  </ol>
</nav>
 
<!-- Flash messages (same page) -->
<div class="container">
  {% with msgs = get_flashed_messages(with_categories=true) %}
    {% if msgs %}
      {% for cat, msg in msgs %}
        <div class="alert alert-{{ 'success' if cat=='success' else ('warning' if cat=='warning' else ('info' if cat=='info' else 'danger')) }} alert-dismissible fade show" role="alert">
          {{ msg }}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endfor %}
    {% endif %}
  {% endwith %}
</div>
 
<!-- Page Content -->
<div class="container my-4">
  <div class="card p-4">
    <h4>Card Applications Submitted</h4>
 
    <!-- Filters -->
    <div class="d-flex justify-content-center mb-4">
      <!-- Card Type Filter -->
      <div class="dropdown me-3">
        <button class="btn nav-btn dropdown-toggle" type="button" id="cardTypeFilterBtn" data-bs-toggle="dropdown">
          All Cards
        </button>
        <ul class="dropdown-menu" aria-labelledby="cardTypeFilterBtn">
          <li><a class="dropdown-item" href="#" data-card-type="all">All Cards</a></li>
          <li><a class="dropdown-item" href="#" data-card-type="credit">Credit Card</a></li>
          <li><a class="dropdown-item" href="#" data-card-type="debit">Debit Card</a></li>
          <li><a class="dropdown-item" href="#" data-card-type="prepaid">Prepaid Card</a></li>
        </ul>
      </div>
 
      <!-- Status Filter -->
      <div class="dropdown">
        <button class="btn nav-btn dropdown-toggle" type="button" id="statusFilterBtn" data-bs-toggle="dropdown">
          All Statuses
        </button>
        <ul class="dropdown-menu" aria-labelledby="statusFilterBtn">
          <li><a class="dropdown-item" href="#" data-status="all">All Statuses</a></li>
          <li><a class="dropdown-item" href="#" data-status="approved">Approved</a></li>
          <li><a class="dropdown-item" href="#" data-status="pending_manager">Pending</a></li>
          <li><a class="dropdown-item" href="#" data-status="issued">Issued</a></li>
          <li><a class="dropdown-item" href="#" data-status="declined">Declined</a></li>
        </ul>
      </div>
    </div>
 
    <!-- Applications Table -->
    <div class="table-responsive">
      <table class="table table-hover align-middle bg-white">
        <thead>
          <tr>
            <th>Ref</th>
            <th>User ID</th>
            <th>Customer Name</th>
            <th>Card Type</th>
            <th>Status</th>
            <th>Applied Date</th>
            <th>Manager Approval Date</th>
          </tr>
        </thead>
        <tbody id="applicationsTableBody">
          {% for a in apps %}
          <tr data-type="{{ a.card_type|lower }}" data-status="{{ a.status|lower }}">
            <td>{{ a.application_ref or 'â€”' }}</td>
            <td>{{ a.customer_user_id or 'â€”' }}</td>
            <td>{{ a.customer_name }}</td>
            <td>{{ a.card_type_label }}{% if a.card_subtype %} ({{ a.card_subtype|upper }}){% endif %}</td>
            <td>
              <span class="badge
                {% if a.status == 'approved' %}bg-success
                {% elif a.status in ['pending','pending_manager'] %}bg-warning text-dark
                {% elif a.status == 'issued' %}bg-primary
                {% elif a.status == 'declined' %}bg-danger
                {% else %}bg-secondary{% endif %}">
                {{ a.status_label }}
              </span>
            </td>
            <td>
              {% if a.created_at %}
                {% if a.created_at.strftime %}{{ a.created_at.strftime('%Y-%m-%d %H:%M') }}
                {% else %}{{ a.created_at }}{% endif %}
              {% else %}â€”{% endif %}
            </td>
            <td>
              {% if a.date_of_action %}
                {% if a.date_of_action.strftime %}{{ a.date_of_action.strftime('%Y-%m-%d %H:%M') }}
                {% else %}{{ a.date_of_action }}{% endif %}
              {% else %}â€”{% endif %}
            </td>
          </tr>
          {% else %}
          <tr><td colspan="7" class="text-center py-4 text-muted">No applications yet.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
 
<!-- Footer -->
<footer>Â© 2025 DigiBank. All rights reserved.</footer>
 
<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
 
<!-- Filter logic -->
<script>
  const tbody   = document.getElementById('applicationsTableBody');
  const typeBtn = document.getElementById('cardTypeFilterBtn');
  const statBtn = document.getElementById('statusFilterBtn');
 
  let activeType = 'all';
  let activeStat = 'all';
 
  function applyFilters() {
    const rows = tbody.querySelectorAll('tr');
    rows.forEach(row => {
      const t = (row.getAttribute('data-type') || '').toLowerCase();
      const s = (row.getAttribute('data-status') || '').toLowerCase();
      const okType = (activeType === 'all') || (t === activeType);
      const okStat = (activeStat === 'all') || (s === activeStat);
      row.style.display = (okType && okStat) ? '' : 'none';
    });
  }
 
  document.querySelectorAll('[data-card-type]').forEach(item => {
    item.addEventListener('click', e => {
      e.preventDefault();
      activeType = item.getAttribute('data-card-type');
      typeBtn.textContent =
        activeType === 'all' ? 'All Cards' :
        activeType === 'credit' ? 'Credit Card' :
        activeType === 'debit'  ? 'Debit Card'  : 'Prepaid Card';
      applyFilters();
    });
  });
 
  document.querySelectorAll('[data-status]').forEach(item => {
    item.addEventListener('click', e => {
      e.preventDefault();
      activeStat = item.getAttribute('data-status');
      statBtn.textContent =
        activeStat === 'all' ? 'All Statuses' :
        activeStat === 'pending_manager' ? 'Pending' :
        activeStat.charAt(0).toUpperCase() + activeStat.slice(1);
      applyFilters();
    });
  });
</script>
</body>
</html>
 
 