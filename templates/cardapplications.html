<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Card Applications</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
 
  <!-- Bootstrap CSS & Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
 
  <style>
    body {
      background-color: #f8f9fa;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    .navbar {
      background-color: #97144D;
    }
    .navbar-brand {
      font-weight: bold;
      color: white !important;
    }
    .nav-btn {
      background-color: white;
      color: #97144D;
      border: 1px solid #97144D;
      margin: 0 5px;
    }
    .nav-btn:hover, .nav-btn.active {
      background-color: #97144D;
      color: white;
    }
    .card {
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    footer {
      background-color: #97144D;
      color: white;
      text-align: center;
      padding: 15px;
      margin-top: 40px;
    }
    .table-responsive {
      border-radius: 12px;
    }
    /* Breadcrumb styling */
    .breadcrumb-item a {
      color: #97144D;
    }
    .breadcrumb-item a:hover {
      color: #7a103e;
    }
  </style>
</head>
<body>
 
<!-- Top Bar -->
<div class="top-bar d-flex align-items-center px-3 py-2" style="background-color:#8B0A50; color:white;">
 
 
  <!-- Logo / Image -->
  <img src="{{ url_for('static', filename='images/logo.jpg') }}" alt="Logo"
       style="height: 40px; width:auto; background-color:#fff; border-radius:5px; padding:2px;" class="me-3">
 
  <!-- Title -->
  <h5 class="flex-grow-1 text-center m-0">Welcome To Cards Agent Dashboard - DigiBank</h5>
 
  <!-- Logout Button -->
  <a href="{{ url_for('logout') }}" class="btn btn-outline-light btn-sm ms-3">
    Logout
  </a>
</div>
      <!-- Breadcrumb -->
     <nav aria-label="breadcrumb" style="background-color:#f8f9fa; padding:8px 15px; border-radius:4px; margin:10px 20px;">
    <ol class="breadcrumb mt-0">
      <li class="breadcrumb-item"><a href="{{ url_for('dashboard') }}" style="color:#97144D;">Home</a></li>
      <li class="breadcrumb-item active" aria-current="page" style="color:#97144D; font-weight:bold;"> Card Applications
      </li>
    </ol>
  </nav>
  <!-- Page Content -->
  <div class="container my-4">
    <div class="card p-4">
      <h4 class="mb-4">Card Applications Submitted</h4>
<!-- Filters -->
    <div class="d-flex justify-content-center mb-4">
      <!-- Card Type Filter -->
      <div class="dropdown me-3">
        <button class="btn nav-btn dropdown-toggle" type="button" id="cardTypeFilterBtn" data-bs-toggle="dropdown">
          All Cards
        </button>
        <ul class="dropdown-menu" aria-labelledby="cardTypeFilterBtn">
          <li><a class="dropdown-item" href="#" data-card-type="all">All Cards</a></li>
          <li><a class="dropdown-item" href="#" data-card-type="credit">Credit Card</a></li>
          <li><a class="dropdown-item" href="#" data-card-type="debit">Debit Card</a></li>
          <li><a class="dropdown-item" href="#" data-card-type="prepaid">Prepaid Card</a></li>
        </ul>
      </div>
 
   <!-- Status Filter -->
      <div class="dropdown">
        <button class="btn nav-btn dropdown-toggle" type="button" id="statusFilterBtn" data-bs-toggle="dropdown" aria-expanded="false">
          All Statuses
        </button>
        <ul class="dropdown-menu" aria-labelledby="statusFilterBtn">
          <li><a class="dropdown-item" href="#" data-status="all">All Statuses</a></li>
          <li><a class="dropdown-item" href="#" data-status="approved">Approved</a></li>
          <li><a class="dropdown-item" href="#" data-status="pending_manager">Pending</a></li>
          <li><a class="dropdown-item" href="#" data-status="issued">Issued</a></li>
          <li><a class="dropdown-item" href="#" data-status="declined">Declined</a></li>
        </ul>
      </div>
    </div>
 
    <!-- Applications Table -->
    <div class="table-responsive">
      <table class="table table-hover align-middle bg-white">
        <thead class="bg-light">
          <tr>
            <th>Ref</th>
            <th>User ID</th>
            <th>Customer Name</th>
            <th>Card Type</th>
            <th>Status</th>
            <th>Applied Date</th>
            <th>Manager Approval Date</th>
          </tr>
        </thead>
        <tbody id="applicationsTableBody">
          {% for a in apps %}
          <tr data-type="{{ a.card_type|lower }}" data-status="{{ a.status|lower }}">
            <td>{{ a.application_ref or '—' }}</td>
            <td>{{ a.customer_user_id or '—' }}</td>
            <td>{{ a.customer_name }}</td>
            <td>{{ a.card_type_label }}{% if a.card_subtype %} ({{ a.card_subtype|upper }}){% endif %}</td>
            <td>
              <span class="badge
                {% if a.status == 'approved' %}bg-success
                {% elif a.status in ['pending','pending_manager'] %}bg-warning text-dark
                {% elif a.status == 'issued' %}bg-primary
                {% elif a.status == 'declined' %}bg-danger
                {% else %}bg-secondary{% endif %}">
                {{ a.status_label }}
              </span>
            </td>
            <td>
              {% if a.created_at %}
                {{ a.created_at.strftime('%Y-%m-%d %H:%M') }}
              {% else %}—{% endif %}
            </td>
            <td>
              {% if a.manager_approval_date %}
                {{ a.manager_approval_date.strftime('%Y-%m-%d %H:%M') }}
              {% else %}—{% endif %}
            </td>
          </tr>
          {% else %}
          <tr><td colspan="7" class="text-center py-4 text-muted">No applications yet.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
 
<footer>© 2025 DigiBank. All rights reserved.</footer>
 
<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
 
<!-- Filter logic -->
<script>
  const tbody   = document.getElementById('applicationsTableBody');
  const typeBtn = document.getElementById('cardTypeFilterBtn');
  const statBtn = document.getElementById('statusFilterBtn');
 
  let activeType = 'all';
  let activeStat = 'all';
 
  function applyFilters() {
    const rows = tbody.querySelectorAll('tr');
    rows.forEach(row => {
      const t = (row.getAttribute('data-type') || '').toLowerCase();
      const s = (row.getAttribute('data-status') || '').toLowerCase();
      const okType = (activeType === 'all') || (t === activeType);
      const okStat = (activeStat === 'all') || (s === activeStat);
      row.style.display = (okType && okStat) ? '' : 'none';
    });
  }
 
  // Type filter
  document.querySelectorAll('[data-card-type]').forEach(item => {
    item.addEventListener('click', e => {
      e.preventDefault();
      activeType = item.getAttribute('data-card-type');
      typeBtn.textContent =
        activeType === 'all' ? 'All Cards' :
        activeType === 'credit' ? 'Credit Card' :
        activeType === 'debit'  ? 'Debit Card'  : 'Prepaid Card';
      applyFilters();
    });
  });
 
  // Status filter
  document.querySelectorAll('[data-status]').forEach(item => {
    item.addEventListener('click', e => {
      e.preventDefault();
      activeStat = item.getAttribute('data-status');
      statBtn.textContent =
        activeStat === 'all' ? 'All Statuses' :
        activeStat === 'pending_manager' ? 'Pending' :
        activeStat.charAt(0).toUpperCase() + activeStat.slice(1);
      applyFilters();
    });
  });
</script>
</body>
</html>
 