<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Card Applications</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
 
  <!-- Fonts & Icons -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
 
  <!-- Bootstrap CSS & Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
 
  <style>
    :root {
      --primary-color: #0B4D83;
      --secondary-color: #1976D2;
      --accent-color: #FF6B35;
      --success-color: #00C853;
      --warning-color: #FF8F00;
      --dark-color: #263238;
      --light-color: #F8F9FA;
      --gradient-primary: linear-gradient(135deg, #0B4D83 0%, #1976D2 100%);
      --gradient-secondary: linear-gradient(135deg, #FF6B35 0%, #FF8F00 100%);
      --shadow-light: 0 4px 20px rgba(11, 77, 131, 0.1);
      --shadow-medium: 0 8px 30px rgba(11, 77, 131, 0.15);
      --shadow-heavy: 0 15px 40px rgba(11, 77, 131, 0.2);
    }
 
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
 
    body {
      font-family: 'Poppins', sans-serif;
      line-height: 1.6;
      color: var(--dark-color);
      background: linear-gradient(135deg, rgba(11, 77, 131, 0.02), rgba(25, 118, 210, 0.02));
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
 
    /* Top Bar */
    .top-bar {
      background: var(--gradient-primary);
      color: white;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.8rem 1.5rem;
      box-shadow: var(--shadow-medium);
    }
 
    .top-bar img {
      height: 45px;
      width: auto;
      border-radius: 6px;
      background: #fff;
      padding: 3px;
    }
 
    .top-bar h5 {
      font-weight: 600;
      margin: 0;
    }
 
    .top-bar .btn-outline-light {
      border: 1.5px solid white;
      color: white;
      font-weight: 500;
      transition: all 0.3s ease;
    }
 
    .top-bar .btn-outline-light:hover {
      background: white;
      color: var(--primary-color);
    }
 
    /* Breadcrumb */
    .breadcrumb {
      background: linear-gradient(135deg, rgba(11, 77, 131, 0.05), rgba(25, 118, 210, 0.05));
      border-radius: 15px;
      padding: 1rem 1.5rem;
      margin: 1.5rem;
      box-shadow: var(--shadow-light);
    }
 
    .breadcrumb .breadcrumb-item a {
      color: var(--primary-color);
      text-decoration: none;
      font-weight: 500;
      transition: all 0.3s ease;
    }
 
    .breadcrumb .breadcrumb-item a:hover {
      text-decoration: underline;
      color: var(--secondary-color);
    }
 
    .breadcrumb .breadcrumb-item.active {
      color: var(--primary-color);
      font-weight: 600;
    }
 
    /* Card container */
    .card {
      border-radius: 20px;
      box-shadow: var(--shadow-light);
      transition: all 0.4s ease;
      background: linear-gradient(145deg, #ffffff, #f8f9fa);
      animation: fadeInUp 0.6s ease-out;
    }
 
    .card:hover {
      transform: translateY(-8px) scale(1.01);
      box-shadow: var(--shadow-heavy);
      background: linear-gradient(145deg, #ffffff, #f0f4ff);
    }
 
    h4 {
      color: var(--primary-color);
      font-weight: 700;
      margin-bottom: 1.5rem;
    }
 
    /* Filter Buttons */
    .nav-btn {
      border: 1.5px solid var(--secondary-color);
      color: var(--secondary-color);
      font-weight: 500;
      transition: all 0.3s ease;
    }
 
    .nav-btn:hover, .nav-btn.active {
      background: var(--secondary-color);
      color: white;
    }
 
    /* Table */
    .table {
      border-radius: 12px;
      overflow: hidden;
      box-shadow: var(--shadow-light);
    }
 
    .table thead {
      background: var(--gradient-primary);
      color: white;
    }
 
    .table-hover tbody tr:hover {
      background-color: rgba(25, 118, 210, 0.08);
    }
 
    /* Footer */
    footer {
      background: var(--gradient-primary);
      color: white;
      text-align: center;
      padding: 15px;
      margin-top: auto;
      box-shadow: var(--shadow-medium);
    }
 
    /* Animations */
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
 
<!-- Top Bar -->
<div class="top-bar">
  <img src="{{ url_for('static', filename='images/logo.jpg') }}" alt="Logo">
  <h5 class="flex-grow-1 text-center">Welcome To Cards Agent Dashboard - DigiBank</h5>
  <a href="{{ url_for('logout') }}" class="btn btn-outline-light btn-sm ms-3">Logout</a>
</div>
 
<!-- Breadcrumb -->
<nav aria-label="breadcrumb">
  <ol class="breadcrumb mb-0">
    <li class="breadcrumb-item"><a href="{{ url_for('dashboard') }}">Home</a></li>
    <li class="breadcrumb-item active" aria-current="page">Card Applications</li>
  </ol>
</nav>
 
<!-- Page Content -->
<div class="container my-4">
  <div class="card p-4">
    <h4>Card Applications Submitted</h4>
 
    <!-- Filters -->
    <div class="d-flex justify-content-center mb-4">
      <!-- Card Type Filter -->
      <div class="dropdown me-3">
        <button class="btn nav-btn dropdown-toggle" type="button" id="cardTypeFilterBtn" data-bs-toggle="dropdown">
          All Cards
        </button>
        <ul class="dropdown-menu" aria-labelledby="cardTypeFilterBtn">
          <li><a class="dropdown-item" href="#" data-card-type="all">All Cards</a></li>
          <li><a class="dropdown-item" href="#" data-card-type="credit">Credit Card</a></li>
          <li><a class="dropdown-item" href="#" data-card-type="debit">Debit Card</a></li>
          <li><a class="dropdown-item" href="#" data-card-type="prepaid">Prepaid Card</a></li>
        </ul>
      </div>
 
      <!-- Status Filter -->
      <div class="dropdown">
        <button class="btn nav-btn dropdown-toggle" type="button" id="statusFilterBtn" data-bs-toggle="dropdown">
          All Statuses
        </button>
        <ul class="dropdown-menu" aria-labelledby="statusFilterBtn">
          <li><a class="dropdown-item" href="#" data-status="all">All Statuses</a></li>
          <li><a class="dropdown-item" href="#" data-status="approved">Approved</a></li>
          <li><a class="dropdown-item" href="#" data-status="pending_manager">Pending</a></li>
          <li><a class="dropdown-item" href="#" data-status="issued">Issued</a></li>
          <li><a class="dropdown-item" href="#" data-status="declined">Declined</a></li>
        </ul>
      </div>
    </div>
 
    <!-- Applications Table -->
    <div class="table-responsive">
      <table class="table table-hover align-middle bg-white">
        <thead>
          <tr>
            <th>Ref</th>
            <th>User ID</th>
            <th>Customer Name</th>
            <th>Card Type</th>
            <th>Status</th>
            <th>Applied Date</th>
            <th>Manager Approval Date</th>
          </tr>
        </thead>
        <tbody id="applicationsTableBody">
          {% for a in apps %}
          <tr data-type="{{ a.card_type|lower }}" data-status="{{ a.status|lower }}">
            <td>{{ a.application_ref or '—' }}</td>
            <td>{{ a.customer_user_id or '—' }}</td>
            <td>{{ a.customer_name }}</td>
            <td>{{ a.card_type_label }}{% if a.card_subtype %} ({{ a.card_subtype|upper }}){% endif %}</td>
            <td>
              <span class="badge
                {% if a.status == 'approved' %}bg-success
                {% elif a.status in ['pending','pending_manager'] %}bg-warning text-dark
                {% elif a.status == 'issued' %}bg-primary
                {% elif a.status == 'declined' %}bg-danger
                {% else %}bg-secondary{% endif %}">
                {{ a.status_label }}
              </span>
            </td>
            <td>
              {% if a.created_at %}
                {{ a.created_at.strftime('%Y-%m-%d %H:%M') }}
              {% else %}—{% endif %}
            </td>
            <td>
              {% if a.manager_approval_date %}
                {{ a.manager_approval_date.strftime('%Y-%m-%d %H:%M') }}
              {% else %}—{% endif %}
            </td>
          </tr>
          {% else %}
          <tr><td colspan="7" class="text-center py-4 text-muted">No applications yet.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
 
<!-- Footer -->
<footer>© 2025 DigiBank. All rights reserved.</footer>
 
<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
 
<!-- Filter logic -->
<script>
  const tbody   = document.getElementById('applicationsTableBody');
  const typeBtn = document.getElementById('cardTypeFilterBtn');
  const statBtn = document.getElementById('statusFilterBtn');
 
  let activeType = 'all';
  let activeStat = 'all';
 
  function applyFilters() {
    const rows = tbody.querySelectorAll('tr');
    rows.forEach(row => {
      const t = (row.getAttribute('data-type') || '').toLowerCase();
      const s = (row.getAttribute('data-status') || '').toLowerCase();
      const okType = (activeType === 'all') || (t === activeType);
      const okStat = (activeStat === 'all') || (s === activeStat);
      row.style.display = (okType && okStat) ? '' : 'none';
    });
  }
 
  document.querySelectorAll('[data-card-type]').forEach(item => {
    item.addEventListener('click', e => {
      e.preventDefault();
      activeType = item.getAttribute('data-card-type');
      typeBtn.textContent =
        activeType === 'all' ? 'All Cards' :
        activeType === 'credit' ? 'Credit Card' :
        activeType === 'debit'  ? 'Debit Card'  : 'Prepaid Card';
      applyFilters();
    });
  });
 
  document.querySelectorAll('[data-status]').forEach(item => {
    item.addEventListener('click', e => {
      e.preventDefault();
      activeStat = item.getAttribute('data-status');
      statBtn.textContent =
        activeStat === 'all' ? 'All Statuses' :
        activeStat === 'pending_manager' ? 'Pending' :
        activeStat.charAt(0).toUpperCase() + activeStat.slice(1);
      applyFilters();
    });
  });
</script>
</body>
</html>
 
 