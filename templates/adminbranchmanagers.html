<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Branch Manager - DigiBank</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
 
  <!-- Bootstrap & Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
 
  <style>
    body {
      background-color: #f8f9fa;
      font-family: 'Segoe UI', sans-serif;
      padding-top: 70px;
      animation: fadeIn 0.6s ease-in-out;
    }
 
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
 
    /* Top Bar */
    .top-bar {
      background-color: #0B4D83;
      color: white;
      padding: 10px 25px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: fixed;
      top: 0;
      width: 100%;
      z-index: 1000;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }
 
    .top-bar img {
      height: 36px;
      margin-right: 10px;
    }
 
    .top-bar h5 {
      margin: 0;
      font-weight: 700;
      flex-grow: 1;
      text-align: center;
      letter-spacing: 0.5px;
    }
 
    .logout-btn {
      background: transparent;
      border: 1.5px solid white;
      color: white;
      padding: 5px 15px;
      border-radius: 4px;
      font-weight: 600;
      transition: 0.3s;
    }
    .logout-btn:hover {
      background-color: white;
      color: #0B4D83;
    }
 
    /* Cards */
    .branch-card {
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      transition: transform 0.3s, box-shadow 0.3s;
    }
    .branch-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    .branch-card-header {
      background: linear-gradient(90deg, #0B4D83, #97144D);
      color: white;
      padding: 15px 20px;
      border-radius: 10px 10px 0 0;
    }
 
    /* Table */
    table.table {
      border-radius: 10px;
      overflow: hidden;
    }
    .table-hover tbody tr:hover {
      background-color: #f5e9ed;
      transition: 0.2s;
    }
    .table thead {
      background-color: #0B4D83;
      color: white;
    }
 
    /* Search box */
    .search-box {
      margin-bottom: 15px;
    }
    .search-input {
      border-radius: 20px;
      padding: 8px 15px;
      border: 1px solid #ccc;
      width: 250px;
    }
 
    footer {
      background-color: #0B4D83;
      color: white;
      text-align: center;
      padding: 12px 0;
      margin-top: 50px;
    }
    .top-bar h5{
        color: #0B4D83;
    }
  </style>
</head>
 
<body>
  <div class="top-bar">
    <div class="d-flex align-items-center">
        <img src="https://upload.wikimedia.org/wikipedia/commons/3/3b/Axis_Bank_logo.svg"
            alt="DigiBank Logo" style="height: 36px; margin-right: 10px;">
        <h5 class="m-0">Branch Management</h5>
    </div>
    </div>
 
      <span class="me-2">Welcome, {{ user.email }}</span>
      <a href="{{ url_for('logout') }}" class="logout-btn">Logout</a>
    </div>
  </div>
 
  <!-- Breadcrumb -->
  <nav aria-label="breadcrumb" class="mt-3 px-3">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="{{ url_for('dashboard') }}" style="color:#0B4D83;">Home</a></li>
      <li class="breadcrumb-item active" style="color: #0B4D83; font-weight:bold;">Branch Management</li>
    </ol>
  </nav>
 
  <!-- Stats Cards -->
  <div class="container my-4">
    <div class="row g-3">
      <div class="col-md-3">
        <div class="card branch-card text-center">
          <div class="card-body">
            <h6 class="text-muted">Total Branches</h6>
            <h3>{{ total_branches }}</h3>
            <i class="bi bi-building text-primary fs-3"></i>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card branch-card text-center">
          <div class="card-body">
            <h6 class="text-muted">Active Branches</h6>
            <h3>{{ active_branches }}</h3>
            <i class="bi bi-check-circle text-success fs-3"></i>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card branch-card text-center">
          <div class="card-body">
            <h6 class="text-muted">Pending Updates</h6>
            <h3>{{ pending_updates }}</h3>
            <i class="bi bi-hourglass-split text-warning fs-3"></i>
          </div>
        </div>
      </div>
    </div>
 
    <!-- Search -->
    <div class="d-flex justify-content-between align-items-center mt-4">
      <h5 class="text-dark fw-bold"><i class="bi bi-bank me-2 text-primary"></i>Branch Manager List</h5>
      <input type="text" id="searchInput" class="search-input" placeholder="ðŸ” Search branch or city...">
    </div>
 
    <!-- Table -->
    <div class="card branch-card mt-3">
      <div class="card-body">
        <div class="table-responsive">
          <table class="table table-hover align-middle text-center">
            <thead>
              <tr>
                <th>Branch ID</th>
                <th>Branch Name</th>
                <th>Manager</th>
                <th>City</th>
                <th>Status</th>
                <th>Opened Date</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="branchTable">
              {% for b in branches %}
              <tr data-branch-id="{{ b.branch_id }}">
                <td>{{ b.branch_id }}</td>
                <td>{{ b.branch_name }}</td>
                <td>{{ b.manager_name }}</td>
                <td>{{ b.city }}</td>
                <td>
                  {% if b.status == 'active' %}
                    <span class="badge bg-success">Active</span>
                  {% elif b.status == 'inactive' %}
                    <span class="badge bg-secondary">Inactive</span>
                  {% elif b.status == 'under review' %}
                    <span class="badge bg-warning text-dark">Under Review</span>
                  {% else %}
                    <span class="badge bg-light text-dark">{{ b.status or 'Unknown' }}</span>
                  {% endif %}
                </td>
                <td>{{ b.opened_date or '-' }}</td>
                <td>
                  <button class="btn btn-sm btn-primary view-btn rounded-pill px-3">View</button>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
 
  <!-- Modal -->
  <div class="modal fade" id="viewBranchModal" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title">Branch Details</h5>
          <button class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body" id="viewBranchModalBody"></div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>
 
  <footer>
    Â© 2025 DigiBank | Branch Manager Dashboard
  </footer>
 
  <!-- JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // View Button
      document.querySelectorAll('.view-btn').forEach(button => {
        button.addEventListener('click', function() {
          const branchId = this.closest('tr').getAttribute('data-branch-id');
          viewBranch(branchId);
        });
      });
 
      // Search filter
      document.getElementById('searchInput').addEventListener('keyup', function() {
        const value = this.value.toLowerCase();
        document.querySelectorAll('#branchTable tr').forEach(row => {
          const text = row.textContent.toLowerCase();
          row.style.display = text.includes(value) ? '' : 'none';
        });
      });
    });
 
    // View branch details
    function viewBranch(branchId) {
      fetch(`/branch-details/${branchId}`)
        .then(res => res.json())
        .then(branch => {
          if (branch.error) return alert("Branch not found");
 
          const body = document.getElementById('viewBranchModalBody');
          body.innerHTML = `
            <div class="row">
              <div class="col-md-4 text-center">
                <i class="bi bi-bank fs-1 text-primary mb-3"></i>
                <h4>${branch.branch_name}</h4>
                <p class="text-muted">Branch ID: ${branch.branch_id}</p>
                <span class="badge ${
                  branch.status === 'active' ? 'bg-success' :
                  branch.status === 'inactive' ? 'bg-secondary' :
                  'bg-warning text-dark'
                }">${branch.status}</span>
              </div>
              <div class="col-md-8">
                <h5 class="fw-bold mb-3 text-primary">Branch Information</h5>
                <p><strong>Manager:</strong> ${branch.manager_name}</p>
                <p><strong>Email:</strong> ${branch.email || '-'}</p>
                <p><strong>Phone:</strong> ${branch.phone || '-'}</p>
                <p><strong>City:</strong> ${branch.city}</p>
                <p><strong>State:</strong> ${branch.state}</p>
                <p><strong>Opened Date:</strong> ${branch.opened_date || '-'}</p>
              </div>
            </div>
          `;
          new bootstrap.Modal(document.getElementById('viewBranchModal')).show();
        })
        .catch(() => alert("Error loading branch details"));
    }
  </script>
</body>
</html>
 
 

 